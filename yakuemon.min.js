functionYakuemonTable(table){this.table=table;}YakuemonTable.prototype.has=function(char){returnthis.table.hasOwnProperty(char);};YakuemonTable.prototype.get=function(char){returnthis.has(char)?this.table[char]:null;};YakuemonTable.prototype.set=function(char,classname){returnthis.table[char]=classname;};functionYakuemonParser(table){this.table=table;this.nodes=newArray();this.text=newText();}YakuemonParser.prototype.put=function(char){this.table.has(char)?this.putYakumono(char):this.putUnYakumono(char);};YakuemonParser.prototype.putYakumono=function(char){returnthis.pushYakumono(char);};YakuemonParser.prototype.putUnYakumono=function(char){this.text.data+=char;};YakuemonParser.prototype.pushYakumono=function(char){this.pushUnYakumono();varyakumono=this.generateYakumono(char);this.nodes.push(yakumono);};YakuemonParser.prototype.generateYakumono=function(char){varspan=document.createElement("span");varspanContent=document.createTextNode(char);span.appendChild(spanContent);span.className=this.table.get(char);returnspan;}YakuemonParser.prototype.pushUnYakumono=function(){this.text.data.length&&this.nodes.push(this.text);this.resetYakumono();};YakuemonParser.prototype.resetYakumono=function(){this.text=this.text.data.length?newText():this.text;};YakuemonParser.prototype.getNodes=function(){returnthis.text.data.length?this.nodes.concat([this.text]):this.nodes;};functionYakuemon(table){this.table=newYakuemonTable(table);}Yakuemon.prototype.applySelector=function(selector,parent){parent=parent?parent:document;Array.from(parent.querySelectorAll(selector)).map(this.applyNode,this);};Yakuemon.prototype.applyNode=function(node){Array.from(node.childNodes).map(this.applyTextNode,this);};Yakuemon.prototype.applyTextNode=function(node){if(nodeinstanceofText){varparser=newYakuemonParser(this.table);Array.from(node.data).map(parser.put,parser);parser.getNodes().map(function(nd){node.parentNode.insertBefore(nd,node);});node.parentNode.removeChild(node);}};